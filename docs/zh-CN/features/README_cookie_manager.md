# Cookieç®¡ç†å™¨ä½¿ç”¨è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

Cookieç®¡ç†å™¨æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºç®¡ç†å¾®ä¿¡å…¬ä¼—å·ç™»å½•Cookieçš„å·¥å…·ï¼Œå®ƒæä¾›äº†å®Œæ•´çš„Cookieç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å­˜å‚¨ã€æ›´æ–°ã€çŠ¶æ€ç›‘æ§å’Œå¤‡ä»½ç­‰ã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½

### 1. Cookieå­˜å‚¨ç®¡ç†
- **æŒä¹…åŒ–å­˜å‚¨**: Cookieä¿¡æ¯ä¿å­˜åœ¨JSONé…ç½®æ–‡ä»¶ä¸­
- **è‡ªåŠ¨æ›´æ–°**: è®°å½•æ¯æ¬¡Cookieçš„æ›´æ–°æ—¶é—´
- **çŠ¶æ€è·Ÿè¸ª**: å®æ—¶ç›‘æ§Cookieçš„æœ‰æ•ˆæ€§

### 2. æ™ºèƒ½çŠ¶æ€æ£€æµ‹
- **æ–°é²œçŠ¶æ€** (â‰¤2å°æ—¶): âœ… ç»¿è‰²æ˜¾ç¤ºï¼Œè¡¨ç¤ºCookieå¯ç”¨
- **å»ºè®®æ›´æ–°** (2-24å°æ—¶): âš ï¸ é»„è‰²è­¦å‘Šï¼Œå»ºè®®æ›´æ–°
- **å·²è¿‡æœŸ** (>24å°æ—¶): âŒ çº¢è‰²é”™è¯¯ï¼Œéœ€è¦æ›´æ–°

### 3. è´¦å·ç®¡ç†
- **é¢„è®¾è´¦å·**: æ”¯æŒå¸¸è§çš„å…¬ä¼—å·è´¦å·
- **è‡ªå®šä¹‰è´¦å·**: å¯ä»¥æ·»åŠ æ–°çš„å…¬ä¼—å·è´¦å·
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ›´æ–°å’ŒçŠ¶æ€æ£€æŸ¥

### 4. å¤‡ä»½ä¸æ¢å¤
- **è‡ªåŠ¨å¤‡ä»½**: æ”¯æŒé…ç½®æ–‡ä»¶è‡ªåŠ¨å¤‡ä»½
- **æ—¶é—´æˆ³å‘½å**: å¤‡ä»½æ–‡ä»¶åŒ…å«æ—¶é—´æˆ³ï¼Œä¾¿äºç®¡ç†
- **é…ç½®æ¢å¤**: å¯ä»¥ä»å¤‡ä»½æ–‡ä»¶æ¢å¤é…ç½®

## ğŸ“ æ–‡ä»¶ç»“æ„

```
app/
â”œâ”€â”€ cookies_config.json          # Cookieé…ç½®æ–‡ä»¶
â”œâ”€â”€ cookie_manager.py            # Cookieç®¡ç†å™¨æ ¸å¿ƒç±»
â””â”€â”€ pages/
    â””â”€â”€ 14_Data_Upload.py       # é›†æˆäº†Cookieç®¡ç†çš„é¡µé¢

backups/                         # å¤‡ä»½ç›®å½•
â””â”€â”€ cookies_config_backup_YYYYMMDD_HHMMSS.json
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨

```python
from app.cookie_manager import CookieManager

# åˆ›å»ºCookieç®¡ç†å™¨å®ä¾‹
cookie_manager = CookieManager()

# è®¾ç½®Cookie
cookie_manager.set_cookie("AGIè§‚å¯Ÿå®¤", "your_cookie_string_here")

# è·å–Cookie
cookie = cookie_manager.get_cookie("AGIè§‚å¯Ÿå®¤")

# æ£€æŸ¥CookieçŠ¶æ€
status = cookie_manager.get_cookie_status("AGIè§‚å¯Ÿå®¤")
```

### 2. åœ¨Streamlité¡µé¢ä¸­ä½¿ç”¨

```python
# åˆå§‹åŒ–Cookieç®¡ç†å™¨
if 'cookie_manager' not in st.session_state:
    st.session_state.cookie_manager = CookieManager()

cookie_manager = st.session_state.cookie_manager

# æ˜¾ç¤ºCookieçŠ¶æ€
status = cookie_manager.get_cookie_status(account_name)
if status["status"] == "fresh":
    st.success("âœ… Cookieæ–°é²œ")
elif status["status"] == "expired":
    st.error("âŒ Cookieå·²è¿‡æœŸ")
```

## ğŸ“Š é…ç½®æ–‡ä»¶æ ¼å¼

```json
{
  "cookies": {
    "AGIè§‚å¯Ÿå®¤": {
      "cookie_string": "ua_id=...; wxuin=...; ...",
      "last_updated": "2025-01-15T10:00:00",
      "status": "active",
      "description": "AGIè§‚å¯Ÿå®¤å…¬ä¼—å·çš„ç™»å½•cookie"
    }
  },
  "metadata": {
    "version": "1.0",
    "created_at": "2025-01-15T10:00:00",
    "last_modified": "2025-01-15T10:00:00",
    "description": "å¾®ä¿¡å…¬ä¼—å·ç™»å½•Cookieé…ç½®æ–‡ä»¶"
  }
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. å¾®ä¿¡å…¬ä¼—å·æ•°æ®è·å–
- è‡ªåŠ¨è·å–å…¬ä¼—å·é˜…è¯»é‡ã€ç‚¹èµæ•°ç­‰æ•°æ®
- æ— éœ€æ‰‹åŠ¨å¯¼å‡ºExcelæ–‡ä»¶
- æ”¯æŒå¤šä¸ªå…¬ä¼—å·è´¦å·ç®¡ç†

### 2. ç™»å½•çŠ¶æ€ç®¡ç†
- ç›‘æ§Cookieçš„æœ‰æ•ˆæ€§
- åŠæ—¶æé†’æ›´æ–°è¿‡æœŸçš„Cookie
- é¿å…å› Cookieè¿‡æœŸå¯¼è‡´çš„æ•°æ®è·å–å¤±è´¥

### 3. å›¢é˜Ÿåä½œ
- ç»Ÿä¸€çš„Cookieé…ç½®ç®¡ç†
- é…ç½®æ–‡ä»¶å¯ä»¥å…±äº«ç»™å›¢é˜Ÿæˆå‘˜
- æ”¯æŒé…ç½®æ–‡ä»¶çš„å¤‡ä»½å’Œæ¢å¤

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. Cookieå®‰å…¨æ€§
- CookieåŒ…å«ç™»å½•å‡­è¯ï¼Œè¯·å¦¥å–„ä¿ç®¡
- ä¸è¦å°†Cookieä¿¡æ¯æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- å®šæœŸæ›´æ–°Cookieä»¥ç¡®ä¿å®‰å…¨æ€§

### 2. æœ‰æ•ˆæœŸç®¡ç†
- å¾®ä¿¡Cookieé€šå¸¸æœ‰æ•ˆæœŸä¸º24å°æ—¶
- å»ºè®®æ¯12å°æ—¶æ£€æŸ¥ä¸€æ¬¡CookieçŠ¶æ€
- å¦‚æœè·å–æ•°æ®å¤±è´¥ï¼Œé¦–å…ˆæ£€æŸ¥Cookieæ˜¯å¦è¿‡æœŸ

### 3. é…ç½®æ–‡ä»¶ç®¡ç†
- å®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶
- æ›´æ–°Cookieåä¼šè‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶
- æ”¯æŒå¤šä¸ªç¯å¢ƒçš„é…ç½®æ–‡ä»¶ç®¡ç†

## ğŸ” æ•…éšœæ’é™¤

### 1. Cookieè·å–å¤±è´¥
```python
# æ£€æŸ¥CookieçŠ¶æ€
status = cookie_manager.get_cookie_status("è´¦å·åç§°")
if status["is_expired"]:
    print("Cookieå·²è¿‡æœŸï¼Œéœ€è¦æ›´æ–°")
```

### 2. é…ç½®æ–‡ä»¶æŸå
```python
# ä»å¤‡ä»½æ¢å¤
backup_path = "backups/cookies_config_backup_20250115_100000.json"
cookie_manager = CookieManager(backup_path)
```

### 3. æƒé™é—®é¢˜
- ç¡®ä¿åº”ç”¨æœ‰è¯»å†™é…ç½®æ–‡ä»¶çš„æƒé™
- æ£€æŸ¥å¤‡ä»½ç›®å½•çš„åˆ›å»ºæƒé™
- éªŒè¯JSONæ–‡ä»¶æ ¼å¼çš„æ­£ç¡®æ€§

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. ç¼“å­˜æœºåˆ¶
- CookieçŠ¶æ€æ£€æŸ¥ç»“æœä¼šè¢«ç¼“å­˜
- å‡å°‘é‡å¤çš„æ–‡ä»¶è¯»å–æ“ä½œ
- æé«˜é¡µé¢å“åº”é€Ÿåº¦

### 2. æ‰¹é‡æ“ä½œ
- æ”¯æŒæ‰¹é‡æ›´æ–°å¤šä¸ªè´¦å·çš„Cookie
- å‡å°‘æ–‡ä»¶I/Oæ“ä½œæ¬¡æ•°
- ä¼˜åŒ–å¤§é‡è´¦å·çš„ç®¡ç†æ•ˆç‡

## ğŸ”® æœªæ¥è®¡åˆ’

### 1. åŠŸèƒ½å¢å¼º
- [ ] æ”¯æŒCookieåŠ å¯†å­˜å‚¨
- [ ] æ·»åŠ Cookieæœ‰æ•ˆæ€§è‡ªåŠ¨æ£€æµ‹
- [ ] é›†æˆå¾®ä¿¡APIè‡ªåŠ¨åˆ·æ–°Cookie

### 2. ç”¨æˆ·ä½“éªŒ
- [ ] æ·»åŠ Cookieè¿‡æœŸæé†’é€šçŸ¥
- [ ] æ”¯æŒCookieæ¨¡æ¿ç®¡ç†
- [ ] æä¾›æ›´ç›´è§‚çš„çŠ¶æ€å¯è§†åŒ–

### 3. é›†æˆæ‰©å±•
- [ ] æ”¯æŒå…¶ä»–å¹³å°çš„Cookieç®¡ç†
- [ ] é›†æˆæ•°æ®åº“å­˜å‚¨
- [ ] æä¾›REST APIæ¥å£

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æ£€æŸ¥é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
2. éªŒè¯Cookieå­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆ
3. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
4. è”ç³»å¼€å‘å›¢é˜Ÿè·å–æ”¯æŒ

---

*æœ€åæ›´æ–°: 2025-01-15*

